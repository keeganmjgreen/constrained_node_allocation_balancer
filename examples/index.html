
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../fair_power_curtailment_problem/">
      
      
        <link rel="next" href="../full_worked_examples/allocating_to_leaves/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Examples - Constrained Node Allocation Balancer</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#examples" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Constrained Node Allocation Balancer" class="md-header__button md-logo" aria-label="Constrained Node Allocation Balancer" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Constrained Node Allocation Balancer
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Examples
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Constrained Node Allocation Balancer" class="md-nav__button md-logo" aria-label="Constrained Node Allocation Balancer" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Constrained Node Allocation Balancer
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Algorithm
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../fair_internet_bandwidth_problem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Fair Internet Bandwidth Problem
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../fair_power_curtailment_problem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Fair Power Curtailment Problem
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simple-case" class="md-nav__link">
    <span class="md-ellipsis">
      Simple case
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#allocating-to-leaves-when-redistribution-is-necessary" class="md-nav__link">
    <span class="md-ellipsis">
      Allocating to leaves when redistribution is necessary
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Allocating to leaves when redistribution is necessary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#two-level-tree" class="md-nav__link">
    <span class="md-ellipsis">
      Two-level tree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#three-level-tree" class="md-nav__link">
    <span class="md-ellipsis">
      Three-level tree
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#allocating-to-leaves-in-proportion-to-the-number-of-leaves-at-or-below" class="md-nav__link">
    <span class="md-ellipsis">
      Allocating to leaves in proportion to the number of leaves at or below
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#allocating-to-leaves-when-adjusting-an-inactive-limits-is-necessary" class="md-nav__link">
    <span class="md-ellipsis">
      Allocating to leaves when adjusting an inactive limit(s) is necessary
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Allocating to leaves when adjusting an inactive limit(s) is necessary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#three-level-tree_1" class="md-nav__link">
    <span class="md-ellipsis">
      Three-level tree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#four-level-tree" class="md-nav__link">
    <span class="md-ellipsis">
      Four-level tree
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Full Worked Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Full Worked Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../full_worked_examples/allocating_to_leaves/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Allocating to leaves
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../full_worked_examples/allocating_to_leaves_without_limits/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Allocating to leaves without limits
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../full_worked_examples/allocating_to_leaves_without_limiting_parent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Allocating to leaves without a limiting parent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../full_worked_examples/allocating_to_leaves_when_redistribution_is_necessary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Allocating to leaves when redistribution is necessary (two-level tree)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../full_worked_examples/allocating_to_leaves_when_redistribution_is_necessary_2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Allocating to leaves when redistribution is necessary (three-level tree)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../full_worked_examples/allocating_to_leaves_in_proportion_to_n_leaves_at_or_below/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Allocating to leaves in proportion to the number of leaves at or below
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../full_worked_examples/reallocating_to_leaves_in_proportion_to_n_leaves_at_or_below/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reallocating to leaves in proportion to the number of leaves at or below
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../full_worked_examples/allocating_to_leaves_when_adjusting_inactive_limit_is_necessary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Allocating to leaves when adjusting an inactive limit(s) is necessary (three-level tree)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../full_worked_examples/allocating_to_leaves_when_adjusting_inactive_limits_is_necessary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Allocating to leaves when adjusting inactive limit(s) is necessary (four-level tree)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simple-case" class="md-nav__link">
    <span class="md-ellipsis">
      Simple case
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#allocating-to-leaves-when-redistribution-is-necessary" class="md-nav__link">
    <span class="md-ellipsis">
      Allocating to leaves when redistribution is necessary
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Allocating to leaves when redistribution is necessary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#two-level-tree" class="md-nav__link">
    <span class="md-ellipsis">
      Two-level tree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#three-level-tree" class="md-nav__link">
    <span class="md-ellipsis">
      Three-level tree
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#allocating-to-leaves-in-proportion-to-the-number-of-leaves-at-or-below" class="md-nav__link">
    <span class="md-ellipsis">
      Allocating to leaves in proportion to the number of leaves at or below
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#allocating-to-leaves-when-adjusting-an-inactive-limits-is-necessary" class="md-nav__link">
    <span class="md-ellipsis">
      Allocating to leaves when adjusting an inactive limit(s) is necessary
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Allocating to leaves when adjusting an inactive limit(s) is necessary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#three-level-tree_1" class="md-nav__link">
    <span class="md-ellipsis">
      Three-level tree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#four-level-tree" class="md-nav__link">
    <span class="md-ellipsis">
      Four-level tree
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="examples">Examples</h1>
<p>Each of the following examples shows a case that the Constrained Node Allocation Balancer algorithm must be able to handle. For simplicity and ease of understanding, they are minimal working examples. Each one corresponds to at least one unit test in the Python package, and links to a full worked example showing the algorithm&rsquo;s step-by-step process.</p>
<h2 id="simple-case">Simple case</h2>
<p><a href="../full_worked_examples/allocating_to_leaves/">Full worked example</a>. Unit test: <code>test_allocating_to_leaves</code></p>
<p>This example consists of a simple two-level tree with one root (node 1, with a limit of 2.0 units) and two leaves (nodes 1.1 and 1.2, with limits of 2.0 units and 1.0 units, respectively):</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Tree visualization</label><label for="__tabbed_1_2">Python code</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<pre class="mermaid"><code>flowchart TD
    1["&lt;b&gt;1&lt;/b&gt;&lt;br&gt;Limit: 2.000"]
    1.1["&lt;b&gt;1.1&lt;/b&gt;&lt;br&gt;Limit: 2.000"]
    1.2["&lt;b&gt;1.2&lt;/b&gt;&lt;br&gt;Limit: 1.000"]
    1 --&gt; 1.1
    1 --&gt; 1.2</code></pre>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">constrained_node_allocation_balancer</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">LeafNode</span><span class="p">,</span>
    <span class="n">Node</span><span class="p">,</span>
    <span class="n">constrained_node_allocation_balancer</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">root</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span>
    <span class="n">limit</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">children</span><span class="o">=</span><span class="p">[</span>
        <span class="n">LeafNode</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">LeafNode</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="p">],</span>
<span class="p">)</span>

<span class="n">constrained_node_allocation_balancer</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p>The algorithm assigns the largest possible allocations that satisfy the root&rsquo;s limit, while balancing how much is allocated among the leaves:</p>
<pre class="mermaid"><code>flowchart TD
    1["&lt;b&gt;1&lt;/b&gt;&lt;br&gt;2.000 / 2.000&lt;br&gt;&lt;code&gt;|█████████|&lt;/code&gt;"]
    1.1["&lt;b&gt;1.1&lt;/b&gt;&lt;br&gt;1.000 / 2.000&lt;br&gt;&lt;code&gt;|█████....|&lt;/code&gt;"]
    1.2["&lt;b&gt;1.2&lt;/b&gt;&lt;br&gt;1.000 / 1.000&lt;br&gt;&lt;code&gt;|█████|....&lt;/code&gt;"]
    1 --&gt; 1.1
    1 --&gt; 1.2</code></pre>
<p>If the leaves had no limits, or their limits were at least the root&rsquo;s limit, the result would be the same as if the leaves&rsquo; limits happened to be inactive.</p>
<ul>
<li><a href="../full_worked_examples/allocating_to_leaves_without_limits/">Full worked example</a>. Unit test: <code>test_allocating_to_leaves_without_limits</code></li>
</ul>
<p>If the root had no limit, or its limit was at least the sum of the leaves&rsquo; limits, node 1.1 would have been allocated 2.0 units.</p>
<ul>
<li><a href="../full_worked_examples/allocating_to_leaves_without_limiting_parent/">Full worked example</a>. Unit test: <code>test_allocating_to_leaves_without_limiting_parent</code></li>
</ul>
<h2 id="allocating-to-leaves-when-redistribution-is-necessary">Allocating to leaves when redistribution is necessary</h2>
<h3 id="two-level-tree">Two-level tree</h3>
<p><a href="../full_worked_examples/allocating_to_leaves_when_redistribution_is_necessary/">Full worked example</a>. Unit test: <code>test_allocating_to_leaves_when_redistribution_is_necessary</code></p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Tree visualization</label><label for="__tabbed_2_2">Python code</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<pre class="mermaid"><code>flowchart TD
    1["&lt;b&gt;1&lt;/b&gt;&lt;br&gt;Limit: 15.000"]
    1.1["&lt;b&gt;1.1&lt;/b&gt;&lt;br&gt;Limit: 6.000"]
    1.2["&lt;b&gt;1.2&lt;/b&gt;&lt;br&gt;Limit: 1.000"]
    1.3["&lt;b&gt;1.3&lt;/b&gt;&lt;br&gt;Limit: 9.000"]
    1 --&gt; 1.1
    1 --&gt; 1.2
    1 --&gt; 1.3</code></pre>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">constrained_node_allocation_balancer</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">LeafNode</span><span class="p">,</span>
    <span class="n">Node</span><span class="p">,</span>
    <span class="n">constrained_node_allocation_balancer</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">root</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span>
    <span class="n">limit</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">children</span><span class="o">=</span><span class="p">[</span>
        <span class="n">LeafNode</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span>
        <span class="n">LeafNode</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">LeafNode</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">9</span><span class="p">),</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="n">constrained_node_allocation_balancer</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p>The above tree has a root allocation of 15.0 units. At first, the algorithm give an initial allocation of (15.0&nbsp;units)/(3&nbsp;nodes)&nbsp;=&nbsp;5.0 units to each of the three leaf nodes. Node 1.1&rsquo;s and node 1.3&rsquo;s initial allocations do <em>not</em> exceed those nodes&rsquo; limits. However, node 1.2&rsquo;s initial allocation <em>does</em> exceed its limit, by 4.0 units. The algorithm will redistribute this excess among the node&rsquo;s siblings that have <em>headroom</em> (limit&nbsp;&minus;&nbsp;allocation), allocating 2.0 more units to each of nodes 1.1 and 1.3. As a result, node 1.1&rsquo;s allocation will end up exceeding its limit by 1.0 unit. This excess will be redistributed among node 1.1&rsquo;s remaining siblings that have headroom (in this case, only node 1.3). The algorithm has thereby assigned the largest possible allocations that satisfy the root’s limit, while balancing how much is allocated among the leaves:</p>
<pre class="mermaid"><code>flowchart TD
    1["&lt;b&gt;1&lt;/b&gt;&lt;br&gt;15.000 / 15.000&lt;br&gt;&lt;code&gt;|█████████|&lt;/code&gt;"]
    1.1["&lt;b&gt;1.1&lt;/b&gt;&lt;br&gt;6.000 / 6.000&lt;br&gt;&lt;code&gt;|████|.....&lt;/code&gt;"]
    1.2["&lt;b&gt;1.2&lt;/b&gt;&lt;br&gt;1.000 / 1.000&lt;br&gt;&lt;code&gt;||.........&lt;/code&gt;"]
    1.3["&lt;b&gt;1.3&lt;/b&gt;&lt;br&gt;8.000 / 9.000&lt;br&gt;&lt;code&gt;|█████▍|...&lt;/code&gt;"]
    1 --&gt; 1.1
    1 --&gt; 1.2
    1 --&gt; 1.3</code></pre>
<h3 id="three-level-tree">Three-level tree</h3>
<p><a href="../full_worked_examples/allocating_to_leaves_when_redistribution_is_necessary_2/">Full worked example</a>. Unit test: <code>test_allocating_to_leaves_when_redistribution_is_necessary_2</code></p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Tree visualization</label><label for="__tabbed_3_2">Python code</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<pre class="mermaid"><code>flowchart TD
    1["&lt;b&gt;1&lt;/b&gt;&lt;br&gt;Limit: Inf"]
    1.1["&lt;b&gt;1.1&lt;/b&gt;&lt;br&gt;Limit: Inf"]
    1.1.1["&lt;b&gt;1.1.1&lt;/b&gt;&lt;br&gt;Limit: 1.000"]
    1.1.2["&lt;b&gt;1.1.2&lt;/b&gt;&lt;br&gt;Limit: 2.000"]
    1.2["&lt;b&gt;1.2&lt;/b&gt;&lt;br&gt;Limit: 2.000"]
    1.2.1["&lt;b&gt;1.2.1&lt;/b&gt;&lt;br&gt;Limit: 1.000"]
    1.2.2["&lt;b&gt;1.2.2&lt;/b&gt;&lt;br&gt;Limit: 2.000"]
    1 --&gt; 1.1
    1.1 --&gt; 1.1.1
    1.1 --&gt; 1.1.2
    1 --&gt; 1.2
    1.2 --&gt; 1.2.1
    1.2 --&gt; 1.2.2</code></pre>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">constrained_node_allocation_balancer</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">LeafNode</span><span class="p">,</span>
    <span class="n">Node</span><span class="p">,</span>
    <span class="n">constrained_node_allocation_balancer</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">root</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span>
    <span class="n">children</span><span class="o">=</span><span class="p">[</span>
        <span class="n">Node</span><span class="p">(</span>
            <span class="n">children</span><span class="o">=</span><span class="p">[</span>
                <span class="n">LeafNode</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">LeafNode</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
            <span class="p">],</span>
        <span class="p">),</span>
        <span class="n">Node</span><span class="p">(</span>
            <span class="n">limit</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">children</span><span class="o">=</span><span class="p">[</span>
                <span class="n">LeafNode</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">LeafNode</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
            <span class="p">],</span>
        <span class="p">),</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="n">constrained_node_allocation_balancer</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p>Result:</p>
<pre class="mermaid"><code>flowchart TD
    1["&lt;b&gt;1&lt;/b&gt;&lt;br&gt;5.000&lt;br&gt;&lt;code&gt;|██████████&lt;/code&gt;"]
    1.1["&lt;b&gt;1.1&lt;/b&gt;&lt;br&gt;3.000 / 3.000&lt;br&gt;&lt;code&gt;|██████|...&lt;/code&gt;"]
    1.1.1["&lt;b&gt;1.1.1&lt;/b&gt;&lt;br&gt;1.000 / 1.000&lt;br&gt;&lt;code&gt;|██|.......&lt;/code&gt;"]
    1.1.2["&lt;b&gt;1.1.2&lt;/b&gt;&lt;br&gt;2.000 / 2.000&lt;br&gt;&lt;code&gt;|████|.....&lt;/code&gt;"]
    1.2["&lt;b&gt;1.2&lt;/b&gt;&lt;br&gt;2.000 / 2.000&lt;br&gt;&lt;code&gt;|████|.....&lt;/code&gt;"]
    1.2.1["&lt;b&gt;1.2.1&lt;/b&gt;&lt;br&gt;1.000 / 1.000&lt;br&gt;&lt;code&gt;|██|.......&lt;/code&gt;"]
    1.2.2["&lt;b&gt;1.2.2&lt;/b&gt;&lt;br&gt;1.000 / 2.000&lt;br&gt;&lt;code&gt;|██..|.....&lt;/code&gt;"]
    1 --&gt; 1.1
    1.1 --&gt; 1.1.1
    1.1 --&gt; 1.1.2
    1 --&gt; 1.2
    1.2 --&gt; 1.2.1
    1.2 --&gt; 1.2.2</code></pre>
<h2 id="allocating-to-leaves-in-proportion-to-the-number-of-leaves-at-or-below">Allocating to leaves in proportion to the number of leaves at or below</h2>
<p><a href="../full_worked_examples/allocating_to_leaves_in_proportion_to_n_leaves_at_or_below/">Full worked example</a>. Unit test: <code>test_allocating_to_leaves_in_proportion_to_n_leaves_at_or_below</code></p>
<p>This example shows how the algorithm does not allocate to nodes evenly, but in proportion to the number of leaves represented by each node. Node 1.1 represents one leaf (because it is a leaf), node 1.2 represents one leaf (because it has one child node that is a leaf), and node 1.3 represents two leaves (because it has two child nodes that are leaves). Rather than splitting the root allocation of 4.0 units evenly and giving each of these three nodes 1.333 units, the algorithm splits the root allocation in proportion to the number of leaves &ldquo;at or below&rdquo;.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Tree visualization</label><label for="__tabbed_4_2">Python code</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<pre class="mermaid"><code>flowchart TD
    1["&lt;b&gt;1&lt;/b&gt;&lt;br&gt;Limit: 4.000"]
    1.1["&lt;b&gt;1.1&lt;/b&gt;&lt;br&gt;Limit: 1.000"]
    1.2["&lt;b&gt;1.2&lt;/b&gt;&lt;br&gt;Limit: Inf"]
    1.2.1["&lt;b&gt;1.2.1&lt;/b&gt;&lt;br&gt;Limit: 2.000"]
    1.3["&lt;b&gt;1.3&lt;/b&gt;&lt;br&gt;Limit: Inf"]
    1.3.1["&lt;b&gt;1.3.1&lt;/b&gt;&lt;br&gt;Limit: 3.000"]
    1.3.2["&lt;b&gt;1.3.2&lt;/b&gt;&lt;br&gt;Limit: 4.000"]
    1 --&gt; 1.1
    1 --&gt; 1.2
    1.2 --&gt; 1.2.1
    1 --&gt; 1.3
    1.3 --&gt; 1.3.1
    1.3 --&gt; 1.3.2</code></pre>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">constrained_node_allocation_balancer</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">LeafNode</span><span class="p">,</span>
    <span class="n">Node</span><span class="p">,</span>
    <span class="n">constrained_node_allocation_balancer</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">root</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span>
    <span class="n">limit</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">children</span><span class="o">=</span><span class="p">[</span>
        <span class="n">LeafNode</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">Node</span><span class="p">(</span>
            <span class="n">children</span><span class="o">=</span><span class="p">[</span>
                <span class="n">LeafNode</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="p">),</span>
        <span class="n">Node</span><span class="p">(</span>
            <span class="n">children</span><span class="o">=</span><span class="p">[</span>
                <span class="n">LeafNode</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
                <span class="n">LeafNode</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="p">),</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="n">constrained_node_allocation_balancer</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p>Result:</p>
<pre class="mermaid"><code>flowchart TD
    1["&lt;b&gt;1&lt;/b&gt;&lt;br&gt;4.000 / 4.000&lt;br&gt;&lt;code&gt;|█████|....&lt;/code&gt;"]
    1.1["&lt;b&gt;1.1&lt;/b&gt;&lt;br&gt;1.000 / 1.000&lt;br&gt;&lt;code&gt;|█|........&lt;/code&gt;"]
    1.2["&lt;b&gt;1.2&lt;/b&gt;&lt;br&gt;1.000 / 2.000&lt;br&gt;&lt;code&gt;|█▍|.......&lt;/code&gt;"]
    1.2.1["&lt;b&gt;1.2.1&lt;/b&gt;&lt;br&gt;1.000 / 2.000&lt;br&gt;&lt;code&gt;|█▍|.......&lt;/code&gt;"]
    1.3["&lt;b&gt;1.3&lt;/b&gt;&lt;br&gt;2.000 / 7.000&lt;br&gt;&lt;code&gt;|██▉......|&lt;/code&gt;"]
    1.3.1["&lt;b&gt;1.3.1&lt;/b&gt;&lt;br&gt;1.000 / 3.000&lt;br&gt;&lt;code&gt;|█▍..|.....&lt;/code&gt;"]
    1.3.2["&lt;b&gt;1.3.2&lt;/b&gt;&lt;br&gt;1.000 / 4.000&lt;br&gt;&lt;code&gt;|█▍...|....&lt;/code&gt;"]
    1 --&gt; 1.1
    1 --&gt; 1.2
    1.2 --&gt; 1.2.1
    1 --&gt; 1.3
    1.3 --&gt; 1.3.1
    1.3 --&gt; 1.3.2</code></pre>
<p>The same principle applies when redistribution is necessary: <a href="../full_worked_examples/reallocating_to_leaves_in_proportion_to_n_leaves_at_or_below/">Full worked example</a>. Unit test: <code>test_reallocating_to_leaves_in_proportion_to_n_leaves_at_or_below</code></p>
<h2 id="allocating-to-leaves-when-adjusting-an-inactive-limits-is-necessary">Allocating to leaves when adjusting an inactive limit(s) is necessary</h2>
<h3 id="three-level-tree_1">Three-level tree</h3>
<p><a href="../full_worked_examples/allocating_to_leaves_when_adjusting_inactive_limit_is_necessary/">Full worked example</a>. Unit test: <code>test_allocating_to_leaves_when_adjusting_inactive_limit_is_necessary</code></p>
<p>As part of its functioning, the algorithm adjusts the limits of any nodes that do not have limits or whose limits can never be reached due to the limits of those node&rsquo;s children. Such nodes&rsquo; limits are referred to as inactive limits. The following tree has a root allocation of 90.0 units, meaning that the initial allocation to nodes 1.1 and 1.2 would be 45.0 units each. The resulting excess that must be redistributed, however, must be (45.0&nbsp;&minus;&nbsp;10.0)&nbsp;=&nbsp;35.0 rather than (45.0&nbsp;&minus;&nbsp;20.0)&nbsp;=&nbsp;25.0 in order to take into account the limits of child node 1.1.1 and sibling node 1.2. To achieve this, node 1.1&rsquo;s limit is adjusted from 20.0 to 10.0. Similarly, the root node&rsquo;s limit is adjusted from infinity to 90.0.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Tree visualization</label><label for="__tabbed_5_2">Python code</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<pre class="mermaid"><code>flowchart TD
    1["&lt;b&gt;1&lt;/b&gt;&lt;br&gt;Limit: Inf"]
    1.1["&lt;b&gt;1.1&lt;/b&gt;&lt;br&gt;Limit: 20.000"]
    1.1.1["&lt;b&gt;1.1.1&lt;/b&gt;&lt;br&gt;Limit: 10.000"]
    1.2["&lt;b&gt;1.2&lt;/b&gt;&lt;br&gt;Limit: 80.000"]
    1.2.1["&lt;b&gt;1.2.1&lt;/b&gt;&lt;br&gt;Limit: 100.000"]
    1 --&gt; 1.1
    1.1 --&gt; 1.1.1
    1 --&gt; 1.2
    1.2 --&gt; 1.2.1</code></pre>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">constrained_node_allocation_balancer</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">LeafNode</span><span class="p">,</span>
    <span class="n">Node</span><span class="p">,</span>
    <span class="n">constrained_node_allocation_balancer</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">root</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span>
    <span class="n">children</span><span class="o">=</span><span class="p">[</span>
        <span class="n">Node</span><span class="p">(</span>
            <span class="n">limit</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>  <span class="c1"># Inactive limit; will be adjusted to `10`.</span>
            <span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="n">LeafNode</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="p">)],</span>
        <span class="p">),</span>
        <span class="n">Node</span><span class="p">(</span>
            <span class="n">limit</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>  <span class="c1"># Active limit.</span>
            <span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="n">LeafNode</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">100</span><span class="p">)],</span>
        <span class="p">),</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="n">constrained_node_allocation_balancer</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p>Result:</p>
<pre class="mermaid"><code>flowchart TD
    1["&lt;b&gt;1&lt;/b&gt;&lt;br&gt;90.000&lt;br&gt;&lt;code&gt;|█████████.&lt;/code&gt;"]
    1.1["&lt;b&gt;1.1&lt;/b&gt;&lt;br&gt;10.000 / 10.000&lt;br&gt;&lt;code&gt;|█|........&lt;/code&gt;"]
    1.1.1["&lt;b&gt;1.1.1&lt;/b&gt;&lt;br&gt;10.000 / 10.000&lt;br&gt;&lt;code&gt;|█|........&lt;/code&gt;"]
    1.2["&lt;b&gt;1.2&lt;/b&gt;&lt;br&gt;80.000 / 80.000&lt;br&gt;&lt;code&gt;|████████|.&lt;/code&gt;"]
    1.2.1["&lt;b&gt;1.2.1&lt;/b&gt;&lt;br&gt;80.000 / 100.000&lt;br&gt;&lt;code&gt;|████████.|&lt;/code&gt;"]
    1 --&gt; 1.1
    1.1 --&gt; 1.1.1
    1 --&gt; 1.2
    1.2 --&gt; 1.2.1</code></pre>
<h3 id="four-level-tree">Four-level tree</h3>
<p><a href="../full_worked_examples/allocating_to_leaves_when_adjusting_inactive_limits_is_necessary/">Full worked example</a>. Unit test: <code>test_allocating_to_leaves_when_adjusting_inactive_limits_is_necessary</code></p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">Tree visualization</label><label for="__tabbed_6_2">Python code</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<pre class="mermaid"><code>flowchart TD
    1["&lt;b&gt;1&lt;/b&gt;&lt;br&gt;Limit: Inf"]
    1.1["&lt;b&gt;1.1&lt;/b&gt;&lt;br&gt;Limit: 9.000"]
    1.1.1["&lt;b&gt;1.1.1&lt;/b&gt;&lt;br&gt;Limit: 1.000"]
    1.1.1.1["&lt;b&gt;1.1.1.1&lt;/b&gt;&lt;br&gt;Limit: 1.000"]
    1.1.2["&lt;b&gt;1.1.2&lt;/b&gt;&lt;br&gt;Limit: 8.000"]
    1.1.2.1["&lt;b&gt;1.1.2.1&lt;/b&gt;&lt;br&gt;Limit: 10.000"]
    1.2["&lt;b&gt;1.2&lt;/b&gt;&lt;br&gt;Limit: 80.000"]
    1.2.1["&lt;b&gt;1.2.1&lt;/b&gt;&lt;br&gt;Limit: 100.000"]
    1 --&gt; 1.1
    1.1 --&gt; 1.1.1
    1.1.1 --&gt; 1.1.1.1
    1.1 --&gt; 1.1.2
    1.1.2 --&gt; 1.1.2.1
    1 --&gt; 1.2
    1.2 --&gt; 1.2.1</code></pre>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">constrained_node_allocation_balancer</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">LeafNode</span><span class="p">,</span>
    <span class="n">Node</span><span class="p">,</span>
    <span class="n">constrained_node_allocation_balancer</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">root</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span>
    <span class="n">children</span><span class="o">=</span><span class="p">[</span>
        <span class="n">Node</span><span class="p">(</span>
            <span class="n">limit</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>  <span class="c1"># Inactive limit; will be adjusted to `10`.</span>
            <span class="n">children</span><span class="o">=</span><span class="p">[</span>
                <span class="n">Node</span><span class="p">(</span>
                    <span class="n">limit</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>  <span class="c1"># Inactive limit; will be adjusted to `1`.</span>
                    <span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="n">LeafNode</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">)],</span>
                <span class="p">),</span>
                <span class="n">Node</span><span class="p">(</span>
                    <span class="n">limit</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>  <span class="c1"># Active limit.</span>
                    <span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="n">LeafNode</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="p">)],</span>
                <span class="p">),</span>
            <span class="p">],</span>
        <span class="p">),</span>
        <span class="n">Node</span><span class="p">(</span>
            <span class="n">limit</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>  <span class="c1"># Active limit.</span>
            <span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="n">LeafNode</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">100</span><span class="p">)],</span>
        <span class="p">),</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="n">constrained_node_allocation_balancer</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p>Result:</p>
<pre class="mermaid"><code>flowchart TD
    1["&lt;b&gt;1&lt;/b&gt;&lt;br&gt;89.000&lt;br&gt;&lt;code&gt;|████████▉.&lt;/code&gt;"]
    1.1["&lt;b&gt;1.1&lt;/b&gt;&lt;br&gt;9.000 / 9.000&lt;br&gt;&lt;code&gt;||.........&lt;/code&gt;"]
    1.1.1["&lt;b&gt;1.1.1&lt;/b&gt;&lt;br&gt;1.000 / 1.000&lt;br&gt;&lt;code&gt;||.........&lt;/code&gt;"]
    1.1.1.1["&lt;b&gt;1.1.1.1&lt;/b&gt;&lt;br&gt;1.000 / 1.000&lt;br&gt;&lt;code&gt;||.........&lt;/code&gt;"]
    1.1.2["&lt;b&gt;1.1.2&lt;/b&gt;&lt;br&gt;8.000 / 8.000&lt;br&gt;&lt;code&gt;||.........&lt;/code&gt;"]
    1.1.2.1["&lt;b&gt;1.1.2.1&lt;/b&gt;&lt;br&gt;8.000 / 10.000&lt;br&gt;&lt;code&gt;|▊|........&lt;/code&gt;"]
    1.2["&lt;b&gt;1.2&lt;/b&gt;&lt;br&gt;80.000 / 80.000&lt;br&gt;&lt;code&gt;|████████|.&lt;/code&gt;"]
    1.2.1["&lt;b&gt;1.2.1&lt;/b&gt;&lt;br&gt;80.000 / 100.000&lt;br&gt;&lt;code&gt;|████████.|&lt;/code&gt;"]
    1 --&gt; 1.1
    1.1 --&gt; 1.1.1
    1.1.1 --&gt; 1.1.1.1
    1.1 --&gt; 1.1.2
    1.1.2 --&gt; 1.1.2.1
    1 --&gt; 1.2
    1.2 --&gt; 1.2.1</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>